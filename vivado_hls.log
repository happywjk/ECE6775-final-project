
****** Vivado(TM) HLS - High-Level Synthesis from C, C++ and SystemC v2019.2 (64-bit)
  **** SW Build 2708876 on Wed Nov  6 21:39:14 MST 2019
  **** IP Build 2700528 on Thu Nov  7 00:09:20 MST 2019
    ** Copyright 1986-2019 Xilinx, Inc. All Rights Reserved.

source /opt/xilinx/Vivado/2019.2/scripts/vivado_hls/hls.tcl -notrace
INFO: Applying HLS Y2K22 patch v1.2 for IP revision
INFO: [HLS 200-10] Running '/opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/vivado_hls'
INFO: [HLS 200-10] For user 'wl764' on host 'en-ec-rhel-ecelinux-10.coecis.cornell.edu' (Linux_x86_64 version 4.18.0-553.82.1.el8_10.x86_64) on Tue Nov 11 11:21:22 EST 2025
INFO: [HLS 200-10] On os "Red Hat Enterprise Linux release 8.10 (Ootpa)"
INFO: [HLS 200-10] In directory '/home/wl764/ece6775/ECE6775-final-project'
Sourcing Tcl script 'run_test.tcl'
INFO: [HLS 200-10] Creating and opening project '/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj'.
INFO: [HLS 200-10] Adding design file 'flash_atten.cpp' to the project
INFO: [HLS 200-10] Adding test bench file 'flash_atten_test.cpp' to the project
INFO: [HLS 200-10] Adding test bench file 'input.data' to the project
INFO: [HLS 200-10] Adding test bench file 'golden.data' to the project
INFO: [HLS 200-10] Creating and opening solution '/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1'.
INFO: [HLS 200-10] Setting target device to 'xc7z020-clg484-1'
INFO: [SYN 201-201] Setting up clock 'default' with a period of 10ns.
INFO: [SIM 211-2] *************** CSIM start ***************
INFO: [SIM 211-4] CSIM will launch GCC as the compiler.
   Compiling ../../../../flash_atten_test.cpp in debug mode
   Compiling ../../../../flash_atten.cpp in debug mode
   Generating csim.exe
========================================
Flash Attention Testbench
========================================
Configuration:
  BATCH_SIZE      = 4
  CONTEXT_LENGTH  = 16
  HIDDEN_SIZE     = 64
  NUM_HEADS       = 4
  HEAD_DIM        = 16
========================================

[Step 1] Reading input data from 'input.data'...
  Successfully read 12288 input values.
  First 5 values: 1.9269 1.4873 0.9007 -2.1055 0.6784 

[Step 2] Running Flash Attention HLS design...
  Design execution completed.
  First 5 output values: 0.4508 0.0583 -0.0648 -0.6239 0.3673 

[Step 3] Writing output data to 'output.data'...
  Successfully wrote 4096 output values.

[Step 4] Checking for golden reference...
  Found 'golden.data', performing comparison...

  Comparison Results:
    Total mismatches: 0 / 4096 (0.00%)
    Max absolute error: 4.7684e-07
    Average absolute error: 4.5008e-08

  ✓ TEST PASSED! All values match within tolerance.

========================================
Testbench completed successfully!
========================================
INFO: [SIM 211-1] CSim done with 0 errors.
INFO: [SIM 211-3] *************** CSIM finish ***************
INFO: [SCHED 204-61] Option 'relax_ii_for_timing' is enabled, will increase II to preserve clock frequency constraints.
INFO: [HLS 200-10] Analyzing design file 'flash_atten.cpp' ... 
INFO: [HLS 200-111] Finished Linking Time (s): cpu = 00:00:41 ; elapsed = 00:00:44 . Memory (MB): peak = 1175.152 ; gain = 530.125 ; free physical = 25978 ; free virtual = 33348
INFO: [HLS 200-111] Finished Checking Pragmas Time (s): cpu = 00:00:41 ; elapsed = 00:00:44 . Memory (MB): peak = 1175.152 ; gain = 530.125 ; free physical = 25978 ; free virtual = 33348
INFO: [HLS 200-10] Starting code transformations ...
INFO: [HLS 200-111] Finished Standard Transforms Time (s): cpu = 00:00:42 ; elapsed = 00:00:46 . Memory (MB): peak = 1178.484 ; gain = 533.457 ; free physical = 25905 ; free virtual = 33290
INFO: [HLS 200-10] Checking synthesizability ...
INFO: [XFORM 203-602] Inlining function 'exp_reduce_::exp' into 'hls::expf' (/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20) automatically.
INFO: [XFORM 203-602] Inlining function 'hls::expf' into 'fast_exp' (flash_atten.cpp:22) automatically.
INFO: [XFORM 203-602] Inlining function 'hls::sqrtf' into 'compute_attention' (flash_atten.cpp:76) automatically.
INFO: [XFORM 203-602] Inlining function 'fast_exp' into 'compute_attention' (flash_atten.cpp:99) automatically.
INFO: [HLS 200-111] Finished Checking Synthesizability Time (s): cpu = 00:00:42 ; elapsed = 00:00:46 . Memory (MB): peak = 1178.484 ; gain = 533.457 ; free physical = 25889 ; free virtual = 33274
INFO: [XFORM 203-502] Unrolling all sub-loops inside loop 'Loop-1.1.1' (flash_atten.cpp:127) in function 'store_output' for pipelining.
INFO: [XFORM 203-502] Unrolling all sub-loops inside loop 'Loop-1.1.1.1' (flash_atten.cpp:84) in function 'compute_attention' for pipelining.
INFO: [XFORM 203-502] Unrolling all sub-loops inside loop 'Loop-1.1' (flash_atten.cpp:37) in function 'load_and_rearrange_qkv' for pipelining.
INFO: [HLS 200-489] Unrolling loop 'Loop-1.1.1.1' (flash_atten.cpp:129) in function 'store_output' completely with a factor of 16.
INFO: [HLS 200-489] Unrolling loop 'Loop-1.1.1.1.1' (flash_atten.cpp:87) in function 'compute_attention' completely with a factor of 16.
INFO: [HLS 200-489] Unrolling loop 'Loop-1.1.1.3' (flash_atten.cpp:105) in function 'compute_attention' completely with a factor of 16.
INFO: [HLS 200-489] Unrolling loop 'Loop-1.1.1' (flash_atten.cpp:39) in function 'load_and_rearrange_qkv' completely with a factor of 192.
INFO: [XFORM 203-101] Partitioning array 'Q'  in dimension 2 completely.
INFO: [XFORM 203-101] Partitioning array 'K'  in dimension 2 completely.
INFO: [XFORM 203-101] Partitioning array 'V'  in dimension 2 completely.
INFO: [XFORM 203-101] Partitioning array 'OUT'  in dimension 2 completely.
INFO: [XFORM 203-101] Partitioning array 'attn_row' (flash_atten.cpp:77) in dimension 1 completely.
INFO: [XFORM 203-602] Inlining function 'exp_reduce_::exp' into 'hls::expf' (/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20) automatically.
INFO: [XFORM 203-602] Inlining function 'hls::expf' into 'fast_exp' (flash_atten.cpp:22) automatically.
INFO: [XFORM 203-602] Inlining function 'fast_exp' into 'compute_attention' (flash_atten.cpp:99) automatically.
INFO: [HLS 200-111] Finished Pre-synthesis Time (s): cpu = 00:00:44 ; elapsed = 00:00:47 . Memory (MB): peak = 1178.484 ; gain = 533.457 ; free physical = 25832 ; free virtual = 33220
INFO: [XFORM 203-541] Flattening a loop nest 'Loop-1.1' (flash_atten.cpp:126:19) in function 'store_output'.
INFO: [XFORM 203-541] Flattening a loop nest 'Loop-1' (flash_atten.cpp:125:16) in function 'store_output'.
INFO: [XFORM 203-541] Flattening a loop nest 'Loop-1' (flash_atten.cpp:36:16) in function 'load_and_rearrange_qkv'.
WARNING: [XFORM 203-542] Cannot flatten a loop nest 'Loop-1.1.1' (flash_atten.cpp:82:22) in function 'compute_attention' : 

more than one sub loop.
INFO: [XFORM 203-541] Flattening a loop nest 'Loop-1.1' (flash_atten.cpp:81:19) in function 'compute_attention'.
INFO: [XFORM 203-541] Flattening a loop nest 'Loop-1' (flash_atten.cpp:80:16) in function 'compute_attention'.
WARNING: [XFORM 203-631] Renaming function 'load_and_rearrange_qkv' to 'load_and_rearrange_q' (flash_atten.cpp:36:34)
INFO: [HLS 200-472] Inferring partial write operation for 'Q.0' (flash_atten.cpp:47:11)
INFO: [HLS 200-472] Inferring partial write operation for 'K.0' (flash_atten.cpp:52:11)
INFO: [HLS 200-472] Inferring partial write operation for 'V.0' (flash_atten.cpp:57:11)
INFO: [HLS 200-472] Inferring partial write operation for 'OUT.0' (flash_atten.cpp:113:11)
INTERNAL-INFO: never seen llvm instruction 'fexp'(507)
INFO: [HLS 200-111] Finished Architecture Synthesis Time (s): cpu = 00:00:45 ; elapsed = 00:00:49 . Memory (MB): peak = 1303.152 ; gain = 658.125 ; free physical = 25793 ; free virtual = 33182
INFO: [HLS 200-10] Starting hardware synthesis ...
INFO: [HLS 200-10] Synthesizing 'top' ...
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-42] -- Implementing module 'load_and_rearrange_q' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [SCHED 204-11] Starting scheduling ...
INFO: [SCHED 204-61] Pipelining loop 'Loop 1'.
WARNING: [SCHED 204-69] Unable to schedule 'load' operation ('input_data_load_2', flash_atten.cpp:41) on array 'input_data' due to limited memory ports. Please consider using a memory core with more ports or partitioning the array 'input_data'.
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 96, Depth = 98.
INFO: [SCHED 204-11] Finished scheduling.
INFO: [HLS 200-111]  Elapsed time: 52.5 seconds; current allocated memory: 283.793 MB.
INFO: [BIND 205-100] Starting micro-architecture generation ...
INFO: [BIND 205-101] Performing variable lifetime analysis.
INFO: [BIND 205-101] Exploring resource sharing.
INFO: [BIND 205-101] Binding ...
INFO: [BIND 205-100] Finished micro-architecture generation.
INFO: [HLS 200-111]  Elapsed time: 1.39 seconds; current allocated memory: 288.420 MB.
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-42] -- Implementing module 'compute_attention' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [SCHED 204-11] Starting scheduling ...
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.1'.
WARNING: [SCHED 204-69] Unable to schedule 'load' operation ('Q_0_load_2', flash_atten.cpp:89) on array 'Q_0' due to limited memory ports. Please consider using a memory core with more ports or partitioning the array 'Q_0'.
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 8, Depth = 92.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.2'.
WARNING: [SCHED 204-68] The II Violation in module 'compute_attention' (Loop: Loop 1.2): Unable to enforce a carried dependence constraint (II = 1, distance = 1, offset = 0)
   between 'phi' operation ('attn_row[15]') with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) and 'phi' operation ('attn_row_15_5', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('sum_exp', flash_atten.cpp:101) and 'fadd' operation ('sum_exp', flash_atten.cpp:101).
WARNING: [SCHED 204-68] The II Violation in module 'compute_attention' (Loop: Loop 1.2): Unable to enforce a carried dependence constraint (II = 2, distance = 1, offset = 0)
   between 'phi' operation ('attn_row[15]') with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) and 'phi' operation ('attn_row_15_5', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('sum_exp', flash_atten.cpp:101) and 'fadd' operation ('sum_exp', flash_atten.cpp:101).
WARNING: [SCHED 204-68] The II Violation in module 'compute_attention' (Loop: Loop 1.2): Unable to enforce a carried dependence constraint (II = 3, distance = 1, offset = 0)
   between 'phi' operation ('attn_row[15]') with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) and 'phi' operation ('attn_row_15_5', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('sum_exp', flash_atten.cpp:101) and 'fadd' operation ('sum_exp', flash_atten.cpp:101).
WARNING: [SCHED 204-68] The II Violation in module 'compute_attention' (Loop: Loop 1.2): Unable to enforce a carried dependence constraint (II = 10, distance = 1, offset = 0)
   between 'phi' operation ('attn_row[15]') with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) and 'phi' operation ('attn_row_15_5', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 11, Depth = 17.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.3'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_s', flash_atten.cpp:111) and 'fadd' operation ('acc_s', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_s', flash_atten.cpp:111) and 'fadd' operation ('acc_s', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_s', flash_atten.cpp:111) and 'fadd' operation ('acc_s', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_s', flash_atten.cpp:111) and 'fadd' operation ('acc_s', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.4'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_1', flash_atten.cpp:111) and 'fadd' operation ('acc_1', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_1', flash_atten.cpp:111) and 'fadd' operation ('acc_1', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_1', flash_atten.cpp:111) and 'fadd' operation ('acc_1', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_1', flash_atten.cpp:111) and 'fadd' operation ('acc_1', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.5'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_2', flash_atten.cpp:111) and 'fadd' operation ('acc_2', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_2', flash_atten.cpp:111) and 'fadd' operation ('acc_2', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_2', flash_atten.cpp:111) and 'fadd' operation ('acc_2', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_2', flash_atten.cpp:111) and 'fadd' operation ('acc_2', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.6'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_3', flash_atten.cpp:111) and 'fadd' operation ('acc_3', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_3', flash_atten.cpp:111) and 'fadd' operation ('acc_3', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_3', flash_atten.cpp:111) and 'fadd' operation ('acc_3', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_3', flash_atten.cpp:111) and 'fadd' operation ('acc_3', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.7'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_4', flash_atten.cpp:111) and 'fadd' operation ('acc_4', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_4', flash_atten.cpp:111) and 'fadd' operation ('acc_4', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_4', flash_atten.cpp:111) and 'fadd' operation ('acc_4', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_4', flash_atten.cpp:111) and 'fadd' operation ('acc_4', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.8'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_5', flash_atten.cpp:111) and 'fadd' operation ('acc_5', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_5', flash_atten.cpp:111) and 'fadd' operation ('acc_5', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_5', flash_atten.cpp:111) and 'fadd' operation ('acc_5', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_5', flash_atten.cpp:111) and 'fadd' operation ('acc_5', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.9'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_6', flash_atten.cpp:111) and 'fadd' operation ('acc_6', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_6', flash_atten.cpp:111) and 'fadd' operation ('acc_6', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_6', flash_atten.cpp:111) and 'fadd' operation ('acc_6', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_6', flash_atten.cpp:111) and 'fadd' operation ('acc_6', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.10'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_7', flash_atten.cpp:111) and 'fadd' operation ('acc_7', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_7', flash_atten.cpp:111) and 'fadd' operation ('acc_7', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_7', flash_atten.cpp:111) and 'fadd' operation ('acc_7', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_7', flash_atten.cpp:111) and 'fadd' operation ('acc_7', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.11'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_8', flash_atten.cpp:111) and 'fadd' operation ('acc_8', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_8', flash_atten.cpp:111) and 'fadd' operation ('acc_8', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_8', flash_atten.cpp:111) and 'fadd' operation ('acc_8', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_8', flash_atten.cpp:111) and 'fadd' operation ('acc_8', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.12'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_9', flash_atten.cpp:111) and 'fadd' operation ('acc_9', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_9', flash_atten.cpp:111) and 'fadd' operation ('acc_9', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_9', flash_atten.cpp:111) and 'fadd' operation ('acc_9', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_9', flash_atten.cpp:111) and 'fadd' operation ('acc_9', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.13'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_10', flash_atten.cpp:111) and 'fadd' operation ('acc_10', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_10', flash_atten.cpp:111) and 'fadd' operation ('acc_10', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_10', flash_atten.cpp:111) and 'fadd' operation ('acc_10', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_10', flash_atten.cpp:111) and 'fadd' operation ('acc_10', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.14'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_11', flash_atten.cpp:111) and 'fadd' operation ('acc_11', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_11', flash_atten.cpp:111) and 'fadd' operation ('acc_11', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_11', flash_atten.cpp:111) and 'fadd' operation ('acc_11', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_11', flash_atten.cpp:111) and 'fadd' operation ('acc_11', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.15'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_12', flash_atten.cpp:111) and 'fadd' operation ('acc_12', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_12', flash_atten.cpp:111) and 'fadd' operation ('acc_12', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_12', flash_atten.cpp:111) and 'fadd' operation ('acc_12', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_12', flash_atten.cpp:111) and 'fadd' operation ('acc_12', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.16'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_13', flash_atten.cpp:111) and 'fadd' operation ('acc_13', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_13', flash_atten.cpp:111) and 'fadd' operation ('acc_13', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_13', flash_atten.cpp:111) and 'fadd' operation ('acc_13', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_13', flash_atten.cpp:111) and 'fadd' operation ('acc_13', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.17'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_14', flash_atten.cpp:111) and 'fadd' operation ('acc_14', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_14', flash_atten.cpp:111) and 'fadd' operation ('acc_14', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_14', flash_atten.cpp:111) and 'fadd' operation ('acc_14', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_14', flash_atten.cpp:111) and 'fadd' operation ('acc_14', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
INFO: [SCHED 204-61] Pipelining loop 'Loop 1.18'.
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 1)
   between 'fadd' operation ('acc_15', flash_atten.cpp:111) and 'fadd' operation ('acc_15', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 2)
   between 'fadd' operation ('acc_15', flash_atten.cpp:111) and 'fadd' operation ('acc_15', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 3)
   between 'fadd' operation ('acc_15', flash_atten.cpp:111) and 'fadd' operation ('acc_15', flash_atten.cpp:111).
WARNING: [SCHED 204-68] Unable to enforce a carried constraint (II = 4)
   between 'fadd' operation ('acc_15', flash_atten.cpp:111) and 'fadd' operation ('acc_15', flash_atten.cpp:111).
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 5, Depth = 13.
WARNING: [SCHED 204-21] Estimated clock period (19.761ns) exceeds the target (target clock period: 10ns, clock uncertainty: 1.25ns, effective delay budget: 8.75ns).
WARNING: [SCHED 204-21] The critical path in module 'compute_attention' consists of the following:
	'fexp' operation ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) [641]  (8.67 ns)
	multiplexor before 'phi' operation ('attn_row[15]') with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) [674]  (1.77 ns)
	'phi' operation ('attn_row[15]') with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) [674]  (0 ns)
	'phi' operation ('attn_row_15_5', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) with incoming values : ('attn_row[0]', flash_atten.cpp:91) ('attn_row[0]', /wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/common/hls_exp_float.cpp:16->/wrk/2019.2/continuous/2019_11_06_2708876/src/products/hls/hls_lib/hlsmath/src/c++/expfloat.cpp:20->flash_atten.cpp:22->flash_atten.cpp:99) [613]  (0 ns)
	'mux' operation ('tmp_52', flash_atten.cpp:99) [639]  (2.06 ns)
	'fsub' operation ('x', flash_atten.cpp:99) [640]  (7.26 ns)
INFO: [SCHED 204-11] Finished scheduling.
INFO: [HLS 200-111]  Elapsed time: 6.24 seconds; current allocated memory: 293.522 MB.
INFO: [BIND 205-100] Starting micro-architecture generation ...
INFO: [BIND 205-101] Performing variable lifetime analysis.
INFO: [BIND 205-101] Exploring resource sharing.
INFO: [BIND 205-101] Binding ...
INFO: [BIND 205-100] Finished micro-architecture generation.
INFO: [HLS 200-111]  Elapsed time: 1.66 seconds; current allocated memory: 301.386 MB.
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-42] -- Implementing module 'store_output' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [SCHED 204-11] Starting scheduling ...
INFO: [SCHED 204-61] Pipelining loop 'Loop 1'.
WARNING: [SCHED 204-69] Unable to schedule 'load' operation ('OUT_0_load_2', flash_atten.cpp:131) on array 'OUT_0' due to limited memory ports. Please consider using a memory core with more ports or partitioning the array 'OUT_0'.
INFO: [SCHED 204-61] Pipelining result : Target II = 1, Final II = 8, Depth = 10.
INFO: [SCHED 204-11] Finished scheduling.
INFO: [HLS 200-111]  Elapsed time: 1.77 seconds; current allocated memory: 302.358 MB.
INFO: [BIND 205-100] Starting micro-architecture generation ...
INFO: [BIND 205-101] Performing variable lifetime analysis.
INFO: [BIND 205-101] Exploring resource sharing.
INFO: [BIND 205-101] Binding ...
INFO: [BIND 205-100] Finished micro-architecture generation.
INFO: [HLS 200-111]  Elapsed time: 0.3 seconds; current allocated memory: 303.397 MB.
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-42] -- Implementing module 'top' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [SCHED 204-11] Starting scheduling ...
INFO: [SCHED 204-11] Finished scheduling.
INFO: [HLS 200-111]  Elapsed time: 0.28 seconds; current allocated memory: 303.496 MB.
INFO: [BIND 205-100] Starting micro-architecture generation ...
INFO: [BIND 205-101] Performing variable lifetime analysis.
INFO: [BIND 205-101] Exploring resource sharing.
INFO: [BIND 205-101] Binding ...
INFO: [BIND 205-100] Finished micro-architecture generation.
INFO: [HLS 200-111]  Elapsed time: 0.39 seconds; current allocated memory: 303.777 MB.
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-10] -- Generating RTL for module 'load_and_rearrange_q' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [RTGEN 206-100] Finished creating RTL model for 'load_and_rearrange_q'.
INFO: [HLS 200-111]  Elapsed time: 0.65 seconds; current allocated memory: 311.993 MB.
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-10] -- Generating RTL for module 'compute_attention' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [SYN 201-210] Renamed object name 'top_faddfsub_32ns_32ns_32_5_full_dsp_1' to 'top_faddfsub_32nsbkb' due to the length limit 20
INFO: [SYN 201-210] Renamed object name 'top_fadd_32ns_32ns_32_5_full_dsp_1' to 'top_fadd_32ns_32ncud' due to the length limit 20
INFO: [SYN 201-210] Renamed object name 'top_fmul_32ns_32ns_32_4_max_dsp_1' to 'top_fmul_32ns_32ndEe' due to the length limit 20
INFO: [SYN 201-210] Renamed object name 'top_fdiv_32ns_32ns_32_16_1' to 'top_fdiv_32ns_32neOg' due to the length limit 20
INFO: [SYN 201-210] Renamed object name 'top_fcmp_32ns_32ns_1_2_1' to 'top_fcmp_32ns_32nfYi' due to the length limit 20
INFO: [SYN 201-210] Renamed object name 'top_fexp_32ns_32ns_32_8_med_dsp_1' to 'top_fexp_32ns_32ng8j' due to the length limit 20
INFO: [RTGEN 206-100] Generating core module 'top_fadd_32ns_32ncud': 1 instance(s).
INFO: [RTGEN 206-100] Generating core module 'top_faddfsub_32nsbkb': 1 instance(s).
INFO: [RTGEN 206-100] Generating core module 'top_fcmp_32ns_32nfYi': 1 instance(s).
INFO: [RTGEN 206-100] Generating core module 'top_fdiv_32ns_32neOg': 1 instance(s).
INFO: [RTGEN 206-100] Generating core module 'top_fexp_32ns_32ng8j': 1 instance(s).
INFO: [RTGEN 206-100] Generating core module 'top_fmul_32ns_32ndEe': 3 instance(s).
INFO: [RTGEN 206-100] Generating core module 'top_mux_164_32_1_1': 17 instance(s).
INFO: [RTGEN 206-100] Generating core module 'top_mux_42_32_1_1': 5 instance(s).
INFO: [RTGEN 206-100] Finished creating RTL model for 'compute_attention'.
INFO: [HLS 200-111]  Elapsed time: 2.44 seconds; current allocated memory: 339.553 MB.
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-10] -- Generating RTL for module 'store_output' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [RTGEN 206-100] Generating core module 'top_mux_42_32_1_1': 2 instance(s).
INFO: [RTGEN 206-100] Finished creating RTL model for 'store_output'.
INFO: [HLS 200-111]  Elapsed time: 2.76 seconds; current allocated memory: 361.491 MB.
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [HLS 200-10] -- Generating RTL for module 'top' 
INFO: [HLS 200-10] ----------------------------------------------------------------
INFO: [RTGEN 206-500] Setting interface mode on port 'top/input_data' to 'ap_memory'.
INFO: [RTGEN 206-500] Setting interface mode on port 'top/output_data' to 'ap_memory'.
INFO: [RTGEN 206-500] Setting interface mode on function 'top' to 'ap_ctrl_hs'.
INFO: [RTGEN 206-100] Finished creating RTL model for 'top'.
INFO: [HLS 200-111]  Elapsed time: 0.81 seconds; current allocated memory: 366.717 MB.
INFO: [HLS 200-790] **** Loop Constraint Status: All loop constraints were NOT satisfied.
INFO: [HLS 200-789] **** Estimated Fmax: 50.60 MHz
INFO: [RTMG 210-278] Implementing memory 'top_Q_0_ram (RAM)' using block RAMs with power-on initialization.
INFO: [RTMG 210-278] Implementing memory 'top_V_0_ram (RAM)' using block RAMs with power-on initialization.
INFO: [RTMG 210-278] Implementing memory 'top_OUT_0_ram (RAM)' using block RAMs with power-on initialization.
INFO: [HLS 200-111] Finished generating all RTL models Time (s): cpu = 00:01:02 ; elapsed = 00:01:16 . Memory (MB): peak = 1368.191 ; gain = 723.164 ; free physical = 25614 ; free virtual = 33060
INFO: [VHDL 208-304] Generating VHDL RTL for top.
INFO: [VLOG 209-307] Generating Verilog RTL for top.
INFO: [COSIM 212-47] Using XSIM for RTL simulation.
INFO: [COSIM 212-14] Instrumenting C test bench ...
   Build using "/opt/xilinx/Vivado/2019.2/tps/lnx64/gcc-6.2.0/bin/g++"
   Compiling flash_atten_test.cpp_pre.cpp.tb.cpp
   Compiling flash_atten.cpp_pre.cpp.tb.cpp
   Compiling apatb_top.cpp
   Generating cosim.tv.exe
INFO: [COSIM 212-302] Starting C TB testing ... 
========================================
Flash Attention Testbench
========================================
Configuration:
  BATCH_SIZE      = 4
  CONTEXT_LENGTH  = 16
  HIDDEN_SIZE     = 64
  NUM_HEADS       = 4
  HEAD_DIM        = 16
========================================

[Step 1] Reading input data from 'input.data'...
  Successfully read 12288 input values.
  First 5 values: 1.9269 1.4873 0.9007 -2.1055 0.6784 

[Step 2] Running Flash Attention HLS design...
  Design execution completed.
  First 5 output values: 0.4508 0.0583 -0.0648 -0.6239 0.3673 

[Step 3] Writing output data to 'output.data'...
  Successfully wrote 4096 output values.

[Step 4] Checking for golden reference...
  Found 'golden.data', performing comparison...

  Comparison Results:
    Total mismatches: 0 / 4096 (0.00%)
    Max absolute error: 4.7684e-07
    Average absolute error: 4.5008e-08

  ✓ TEST PASSED! All values match within tolerance.

========================================
Testbench completed successfully!
========================================
INFO: [COSIM 212-333] Generating C post check test bench ...
INFO: [COSIM 212-12] Generating RTL test bench ...
INFO: [COSIM 212-1] *** C/RTL co-simulation file generation completed. ***
INFO: [COSIM 212-323] Starting verilog simulation. 
INFO: [COSIM 212-15] Starting XSIM ...
INFO: [XSIM 43-3496] Using init file passed via -initfile option "/opt/xilinx/Vivado/2019.2/data/xsim/ip/xsim_ip.ini".
Vivado Simulator 2019.2
Copyright 1986-1999, 2001-2019 Xilinx, Inc. All Rights Reserved.
Running: /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab xil_defaultlib.apatb_top_top glbl -prj top.prj -L smartconnect_v1_0 -L axi_protocol_checker_v1_1_12 -L axi_protocol_checker_v1_1_13 -L axis_protocol_checker_v1_1_11 -L axis_protocol_checker_v1_1_12 -L xil_defaultlib -L unisims_ver -L xpm --initfile /opt/xilinx/Vivado/2019.2/data/xsim/ip/xsim_ip.ini --lib ieee_proposed=./ieee_proposed -s top 
Multi-threading is on. Using 6 slave threads.
Determining compilation order of HDL files.
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/glbl.v" into library work
INFO: [VRFC 10-311] analyzing module glbl
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top.autotb.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module apatb_top_top
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/AESL_automem_input_data.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module AESL_automem_input_data
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/AESL_automem_output_data.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module AESL_automem_output_data
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/load_and_rearrange_q.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module load_and_rearrange_q
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/compute_attention.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module compute_attention
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/store_output.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module store_output
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_faddfsub_32nsbkb.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_faddfsub_32nsbkb
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_fadd_32ns_32ncud.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_fadd_32ns_32ncud
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_fmul_32ns_32ndEe.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_fmul_32ns_32ndEe
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_fdiv_32ns_32neOg.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_fdiv_32ns_32neOg
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_fcmp_32ns_32nfYi.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_fcmp_32ns_32nfYi
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_fexp_32ns_32ng8j.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_fexp_32ns_32ng8j
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_mux_42_32_1_1.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_mux_42_32_1_1
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_mux_164_32_1_1.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_mux_164_32_1_1
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_Q_0.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_Q_0_ram
INFO: [VRFC 10-311] analyzing module top_Q_0
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_V_0.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_V_0_ram
INFO: [VRFC 10-311] analyzing module top_V_0
INFO: [VRFC 10-2263] Analyzing SystemVerilog file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/top_OUT_0.v" into library xil_defaultlib
INFO: [VRFC 10-311] analyzing module top_OUT_0_ram
INFO: [VRFC 10-311] analyzing module top_OUT_0
INFO: [VRFC 10-163] Analyzing VHDL file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/ip/xil_defaultlib/top_ap_faddfsub_3_full_dsp_32.vhd" into library xil_defaultlib
INFO: [VRFC 10-3107] analyzing entity 'top_ap_faddfsub_3_full_dsp_32'
INFO: [VRFC 10-163] Analyzing VHDL file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/ip/xil_defaultlib/top_ap_fadd_3_full_dsp_32.vhd" into library xil_defaultlib
INFO: [VRFC 10-3107] analyzing entity 'top_ap_fadd_3_full_dsp_32'
INFO: [VRFC 10-163] Analyzing VHDL file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/ip/xil_defaultlib/top_ap_fmul_2_max_dsp_32.vhd" into library xil_defaultlib
INFO: [VRFC 10-3107] analyzing entity 'top_ap_fmul_2_max_dsp_32'
INFO: [VRFC 10-163] Analyzing VHDL file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/ip/xil_defaultlib/top_ap_fdiv_14_no_dsp_32.vhd" into library xil_defaultlib
INFO: [VRFC 10-3107] analyzing entity 'top_ap_fdiv_14_no_dsp_32'
INFO: [VRFC 10-163] Analyzing VHDL file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/ip/xil_defaultlib/top_ap_fcmp_0_no_dsp_32.vhd" into library xil_defaultlib
INFO: [VRFC 10-3107] analyzing entity 'top_ap_fcmp_0_no_dsp_32'
INFO: [VRFC 10-163] Analyzing VHDL file "/home/wl764/ece6775/ECE6775-final-project/flash_attention_proj/solution1/sim/verilog/ip/xil_defaultlib/top_ap_fexp_6_med_dsp_32.vhd" into library xil_defaultlib
INFO: [VRFC 10-3107] analyzing entity 'top_ap_fexp_6_med_dsp_32'
Starting static elaboration
Pass Through NonSizing Optimizer
WARNING: [VRFC 10-3499] library name 'floating_point_v7_1_9' of instantiated unit conflicts with visible identifier [ip/xil_defaultlib/top_ap_faddfsub_3_full_dsp_32.vhd:206]
WARNING: [VRFC 10-3499] library name 'floating_point_v7_1_9' of instantiated unit conflicts with visible identifier [ip/xil_defaultlib/top_ap_fadd_3_full_dsp_32.vhd:201]
WARNING: [VRFC 10-3499] library name 'floating_point_v7_1_9' of instantiated unit conflicts with visible identifier [ip/xil_defaultlib/top_ap_fmul_2_max_dsp_32.vhd:201]
WARNING: [VRFC 10-3499] library name 'floating_point_v7_1_9' of instantiated unit conflicts with visible identifier [ip/xil_defaultlib/top_ap_fdiv_14_no_dsp_32.vhd:201]
WARNING: [VRFC 10-3499] library name 'floating_point_v7_1_9' of instantiated unit conflicts with visible identifier [ip/xil_defaultlib/top_ap_fcmp_0_no_dsp_32.vhd:200]
WARNING: [VRFC 10-3499] library name 'floating_point_v7_1_9' of instantiated unit conflicts with visible identifier [ip/xil_defaultlib/top_ap_fexp_6_med_dsp_32.vhd:196]
Completed static elaboration
ERROR: [XSIM 43-3316] Signal SIGSEGV received.
Printing stacktrace...

[0] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/Default/libstdc++.so.6(std::_Rb_tree_increment(std::_Rb_tree_node_base const*)+0x22) [0x7f8e41ec0b82]
[1] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x773ab8]
[2] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x734aa2]
[3] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x73502e]
[4] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x7353f1]
[5] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x7351e0]
[6] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x7351e0]
[7] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x7351e0]
[8] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x7351e0]
[9] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x7345e6]
[10] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x73502e]
[11] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63b938]
[12] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::TraverseArray(Verific::Array const*)+0x86) [0x7f8e4317bd56]
[13] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::Visit(Verific::VeriModule&)+0x98) [0x7f8e43182698]
[14] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63d102]
[15] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x605ccb]
[16] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63b542]
[17] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::TraverseArray(Verific::Array const*)+0x86) [0x7f8e4317bd56]
[18] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::Visit(Verific::VeriModule&)+0x98) [0x7f8e43182698]
[19] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63d102]
[20] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x605ccb]
[21] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63b542]
[22] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::TraverseArray(Verific::Array const*)+0x86) [0x7f8e4317bd56]
[23] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::Visit(Verific::VeriModule&)+0x98) [0x7f8e43182698]
[24] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63d102]
[25] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x605ccb]
[26] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63b542]
[27] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::TraverseArray(Verific::Array const*)+0x86) [0x7f8e4317bd56]
[28] /opt/xilinx/Vivado/2019.2/lib/lnx64.o/libxsimverific.so(Verific::VeriVisitor::Visit(Verific::VeriModule&)+0x98) [0x7f8e43182698]
[29] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x63d102]
[30] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x605ccb]
[31] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x491cb4]
[32] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x4764b2]
[33] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x480253]
[34] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x45241d]
[35] /lib64/libc.so.6(__libc_start_main+0xe5) [0x7f8e414e67e5]
[36] /opt/xilinx/Vivado/2019.2/bin/unwrapped/lnx64.o/xelab() [0x46a3d0]

Done
ERROR: Please check the snapshot name which is created during 'xelab',the current snapshot name "xsim.dir/top/xsimk" does not exist 
ERROR: [COSIM 212-4] *** C/RTL co-simulation finished: FAIL ***
INFO: [COSIM 212-211] II is measurable only when transaction number is greater than 1 in RTL simulation. Otherwise, they will be marked as all NA. If user wants to calculate them, please make sure there are at least 2 transactions in RTL simulation.
command 'ap_source' returned error code
    while executing
"source run_test.tcl"
    invoked from within
"hls::main run_test.tcl"
    ("uplevel" body line 1)
    invoked from within
"uplevel 1 hls::main {*}$args"
    (procedure "hls_proc" line 5)
    invoked from within
"hls_proc $argv"
INFO: [HLS 200-112] Total elapsed time: 144.7 seconds; peak allocated memory: 366.717 MB.
INFO: [Common 17-206] Exiting vivado_hls at Tue Nov 11 11:23:46 2025...
